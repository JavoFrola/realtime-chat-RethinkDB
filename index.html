<!DOCTYPE html>
<html>
    <head>
        
    </head>
    <body>
        <form>
            <input type="text" id="TheInput" class=".message-input"/>
            <input type="button" id="TheButton" class=".message-btn" value="Send" />
        </form>
        <br>
        Messages Below:
        <br>
        <ul class="messages">
            <!-- Messages will be inserted as li's here -->
        </ul>
        
        <br>
        
        
        
        
        <!-- Bring in JQuery -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <!-- Bring in Socket.io -->
        <script src="https://cdn.socket.io/socket.io-1.3.7.js"></script>
        <script>
            var socket = io.connect();
            
            // loads all previous messages
            $.get('/message/all', function(result) {
              var messages = "";
              result.map(function(obj) {
                messages += "<li>Someone said: " + obj.message + "</li>";
              });
              $('.messages').html(messages);
            });
        
            // sends a message to the server
            $('#TheButton').click(function() {
              console.log("Submitting message!");
              var message = $('#TheInput').val();
                $.post('/message/send', {message: message}, function(result) {
                  console.log(result);
                });
            })
            
            
            // Recieves new messages
            socket.on('new_message', function(data) {
              console.log(data);
              $('.messages').prepend("<li>" + data.new_val.message + "</li>");
            });
        </script>
    </body>
</html>